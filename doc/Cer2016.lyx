#LyX 2.0 created this file. For more info see http://www.lyx.org/
\lyxformat 413
\begin_document
\begin_header
\textclass article
\begin_preamble
\usepackage{tikz}
\usepackage{tkz-graph}
\usepackage{pgf}
\usetikzlibrary{arrows,automata}
\end_preamble
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_amsmath 1
\use_esint 1
\use_mhchem 1
\use_mathdots 1
\cite_engine basic
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\listings_params "basicstyle={\scriptsize}"
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Should protracted speciation be incorporated in phylogenetic tree construction
 methods?
\end_layout

\begin_layout Author
RichÃ¨l J.C.
 Bilderbeek & Rampal S.
 Etienne
\end_layout

\begin_layout Section
Abstract
\end_layout

\begin_layout Standard
The construction of phylogenies has proven invaluable in answering evolutionary
 biological questions.
 Our current phylogenetic tools ignore the fact that speciation takes time,
 which has an effect unknown in phylogeny reconstruction.
 Here, we measure the errors that the Bayesian phylogenetic software tool
 BEAST2 gives when recovering simulated phylogenies, for different times-to-spec
iate, under a range of additional parameter settings.
 It has been found that branch lengths are consistently and strongly underestima
ted for biologically relevant parameters.
 This research shows that protractedness is a complexity of nature that
 should not be ignored and should be incorporated in our phylogenetic tools.
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Paragraph
Speciation takes time
\end_layout

\begin_layout Standard
Although we know that speciation takes time, we commonly ignore this when
 constructing a phylogeny, by chosing a constant-rate birth-death model
 as a speciation model.
 The constant-rate birth-death model (as described in for example 
\begin_inset CommandInset citation
LatexCommand cite
key "nee1994"

\end_inset

) is among the simplest speciation models, and assumes instant speciation
 and extinction rates, captured by its two parameters.
 The constant-rate birth-death model is popular for its simplicity, yet
 has also served as a starting point for more elaborate specation models.
\end_layout

\begin_layout Paragraph
Other non-protracted speciation models
\end_layout

\begin_layout Standard
Other speciation models may assume that speciation rate changes in time
 [REF], is dependent on the amount of species present 
\begin_inset CommandInset citation
LatexCommand cite
key "etienne2011diversity"

\end_inset

, or is trait dependent [REF].
 The original model by making speciation rate dependent on time, diversity
 or trait value.
 Also these extended models assume speciation is instantaneous.
\end_layout

\begin_layout Paragraph
Protracted speciation model
\end_layout

\begin_layout Standard
The protracted speciation model 
\begin_inset CommandInset citation
LatexCommand cite
key "rosindell2010protracted"

\end_inset

 allows for speciation taking time.
 It adds an additional species state (see also figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-states-and-transitions-of-a-species"

\end_inset

): the 'incipient' stage, which a lineages has to complete before becoming
 a 'good' species.
 The protracted speciation model makes no assumption about the exact biolologica
l mechanism by which reproductive isolation is acquired 
\begin_inset CommandInset citation
LatexCommand cite
key "etienne2012prolonging,etienne2014estimating,rosindell2010protracted"

\end_inset

, yet matches best to the peripatric mode of speciation, in which species
 occupy a new niche, without gene flow between parental and this incipient
 species.
 The protracted speciation model makes no assumption about speciation and
 extinction rates (these may be contant or depend on time, diversity or
 trait value), but these features can easily be added to the model.
 
\end_layout

\begin_layout Paragraph
Use of a speciation model in inferring a phylogeny
\end_layout

\begin_layout Standard
Speciation models are widely used to make inferences from genetic data.
 There are multiple computer programs to create phylogenies and/or parameter
 estimates from aligned DNA sequences.
 BEAST2 is a widely used tool that allows for a Bayesian approach to phylogeneti
cs
\begin_inset CommandInset citation
LatexCommand cite
key "bouckaert2014beast"

\end_inset

.
 BEAST2 supplies the user with multiple speciation models, that all assume
 instantaneous speciation.
 
\end_layout

\begin_layout Paragraph
This study
\end_layout

\begin_layout Standard
This simulation investigates the consequence of BEAST2 using instantaneous
 speciation, by creating a 'true' tree that is protracted and seeing how
 well BEAST2 can recover it.
 It is expected that for higher protractedness (thus deviation from BEAST2
 its assumptions), the error will increase.
 It is unknown, however, if and when this error is relevant.
 
\end_layout

\begin_layout Paragraph
Preview results
\end_layout

\begin_layout Standard
This study shows that [TODO: put result here]
\end_layout

\begin_layout Section
Methods
\end_layout

\begin_layout Subsection
Model
\end_layout

\begin_layout Standard
The speciation model used in this investigation is a constant-rate protracted
 speciation model.
\end_layout

\begin_layout Standard
A protracted speciation model assumes that species have at least two states:
 a species is either a good or incipient species.
 A good species is a species recognized as such, where an incipient species
 is not yet.
 Both good and incipient species can generate new incipient species, at
 the speciation-initiation rates 
\begin_inset Formula $b_{g}$
\end_inset

 and 
\begin_inset Formula $b_{i}$
\end_inset

 respectively.
 An incipient species can become a good species at the speciation-completion
 rate 
\begin_inset Formula $\lambda$
\end_inset

.
 Both good and incipient species can go extinct at rates 
\begin_inset Formula $\mu_{i}$
\end_inset

 and 
\begin_inset Formula $\mu_{g}$
\end_inset

 respectively (see also figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-states-and-transitions-of-a-species"

\end_inset

).
\end_layout

\begin_layout Standard
The simplest member of the protracted speciation famility is the constant-rate
 protracted speciation model, which assumes that all rates are constant
 in time.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=4cm, semithick
]   
\end_layout

\begin_layout Plain Layout


\backslash
tikzstyle{every state}=[]
\end_layout

\begin_layout Plain Layout


\backslash
node[state] (A)              {Good};   
\end_layout

\begin_layout Plain Layout


\backslash
node[state] (B) [right of=A] {Incipient};   
\end_layout

\begin_layout Plain Layout


\backslash
node[state] (C) [below of=B] {Extinct};   
\end_layout

\begin_layout Plain Layout


\backslash
path (A) edge [bend right] node {$b_g$} (B)
\end_layout

\begin_layout Plain Layout

      (A) edge [bend right] node {$
\backslash
mu_g$} (C)
\end_layout

\begin_layout Plain Layout

      (B) edge [loop above] node {$b_i$} (B)
\end_layout

\begin_layout Plain Layout

      (B) edge [bend right] node {$
\backslash
lambda$} (A)
\end_layout

\begin_layout Plain Layout

      (B) edge [bend right] node {$
\backslash
mu_i$} (C); 
\end_layout

\begin_layout Plain Layout


\backslash
end{tikzpicture}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The states and transitions of a species.
 
\begin_inset Formula $b_{i}$
\end_inset

: speciation-initiation rate of incipient species.
 
\begin_inset Formula $b_{g}$
\end_inset

: speciation-initiation rate of good species.
 
\begin_inset Formula $\lambda$
\end_inset

: speciation completion rate.
 
\begin_inset Formula $\mu_{i}$
\end_inset

: extinction rate of incipient species.
 
\begin_inset Formula $\mu_{g}$
\end_inset

: extinction rate of good species.
 Figure after Etienne et al, 2014, Evolution
\begin_inset CommandInset label
LatexCommand label
name "fig:The-states-and-transitions-of-a-species"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
There is no relationship known between the speciation rate (often called
 
\begin_inset Formula $\lambda$
\end_inset

) of the constant-rate birth-death model and a combination of the speciation-ini
tiation 
\begin_inset Formula $\lambda$
\end_inset

 and speciation-completion rates of the protracted birth-death model (
\begin_inset Formula $b_{g}$
\end_inset

 and 
\begin_inset Formula $b_{i}$
\end_inset

).
 When setting 
\begin_inset Formula $\lambda\rightarrow\infty$
\end_inset

, the model used falls back to a constant-rate (non-protracted) birth-death
 model.
\end_layout

\begin_layout Subsection
Workflow
\end_layout

\begin_layout Subsubsection
Creating incipient species trees
\end_layout

\begin_layout Standard
From a parameter combination, a 'true' protracted constant-rate birth-death
 incipient species tree is simulated in the R programming language 
\begin_inset CommandInset citation
LatexCommand cite
key "R"

\end_inset

, using the PBD package 
\begin_inset CommandInset citation
LatexCommand cite
key "PBD"

\end_inset

.
\end_layout

\begin_layout Paragraph
Speciation-completion rate
\end_layout

\begin_layout Standard
The speciation-completion rate 
\begin_inset Formula $\lambda$
\end_inset

 is pivotal for this study, as when 
\begin_inset Formula $\lambda\rightarrow\infty$
\end_inset

 the model falls back to a birth-death model and satisfies the instantaneous
 speciation assumption of the tools used.
\end_layout

\begin_layout Paragraph
Speciation initiation rate, extinction rate and crown age
\end_layout

\begin_layout Standard
The parameter values for the speciation-initiation rates 
\begin_inset Formula $b$
\end_inset

, extinction rate 
\begin_inset Formula $\mu$
\end_inset

 and phylogeny crown age 
\begin_inset Formula $t_{c}$
\end_inset

 need to be balanced, as 
\begin_inset Formula $t_{c}b\gg\mu$
\end_inset

 results in overly taxon-rich phylogenies, where 
\begin_inset Formula $t_{c}\mu\gg b$
\end_inset

 results in extinction of all lineages.
 As a starting point, we used the parameters used by 
\begin_inset CommandInset citation
LatexCommand cite
key "etienne2014estimating"

\end_inset

.
 For simplicity, we assume species can give rise to new species, independent
 of species status, thus 
\begin_inset Formula $b_{i}=b_{g}$
\end_inset

 [TODO: Is there reason to assume differently?].
 Additionally, we assume a species can go extinct independent of species
 status, so
\begin_inset Formula $\mu_{i}=\mu_{g}$
\end_inset

 [TODO: Is there reason to assume differently?].
 
\end_layout

\begin_layout Subsubsection
Creating species trees
\end_layout

\begin_layout Standard
The longer speciation takes, the higher the number of incipient species
 will be.
 Because BEAST2 assumes one individual per species, we randomly sample one
 individual per species of all species to obtain a species tree.
 This is replicated 
\begin_inset Formula $n_{s}$
\end_inset

 times.
 Also an outgroup is added, so that the phylogeny inferring software can
 root a phylogeny.
 
\end_layout

\begin_layout Subsubsection
Creating a DNA alignment
\end_layout

\begin_layout Standard
From each species tree, 
\begin_inset Formula $n_{a}$
\end_inset

 DNA alignments were simulated following a Jukes-Cantor nucleotide subsititution
 model using the phangorn R package 
\begin_inset CommandInset citation
LatexCommand cite
key "phangorn"

\end_inset

.
\end_layout

\begin_layout Standard
In creating DNA sequence alignments from the phylognies, a mutation rate
 
\begin_inset Formula $r$
\end_inset

 and DNA sequence length 
\begin_inset Formula $l_{a}$
\end_inset

 need to be balanced as well.
 As a starting point, we chose the DNA sequence length to be 1kb, as this
 a common gene sequence length, but we also included one and two orders
 of magnitude bigger.
 The mutation rate is chosen to match a mutation rate as in nature [TODO:
 find that value].
\end_layout

\begin_layout Subsubsection
Creating a BEAST2 posterior
\end_layout

\begin_layout Standard
From these DNA alignments, a posterior containing phylogenies and parameter
 combinations were constructed using the BEAST2 software package 
\begin_inset CommandInset citation
LatexCommand cite
key "bouckaert2014beast"

\end_inset

.
 Per alignment, 
\begin_inset Formula $n_{b}$
\end_inset

 BEAST2 runs were performed, each with an MCMC length of 
\begin_inset Formula $l_{m}$
\end_inset

, to see if both runs result in similar posteriors.
 
\end_layout

\begin_layout Standard
The BEAST2 priors used were as follows: 
\end_layout

\begin_layout Standard
For the site model, the default parameters were used: which is the Jukes-Cantor
 substitution model
\begin_inset Note Note
status open

\begin_layout Plain Layout
Gamma category count of 0 and a 'proportion invariant' of 0
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
For the clock model, the default parameters are used, which is a strict
 clock prior, with a clock rate of 
\begin_inset Formula $1.0$
\end_inset

.
\end_layout

\begin_layout Standard
For the tree prior, the 'Birth Death Model' was selected and its parameters
 kept at the default uniform birth-rate 
\begin_inset Note Note
status open

\begin_layout Plain Layout
birthRate2.t
\end_layout

\end_inset

 (range 
\begin_inset Formula $0$
\end_inset

-
\begin_inset Formula $10^{5}$
\end_inset

, initial value 
\begin_inset Formula $1$
\end_inset

) and default uniform birth-rate 
\begin_inset Note Note
status open

\begin_layout Plain Layout
relativeDeathRate2.t
\end_layout

\end_inset

 (range 
\begin_inset Formula $0$
\end_inset

-
\begin_inset Formula $1$
\end_inset

, initial value 
\begin_inset Formula $0.5$
\end_inset

).
\end_layout

\begin_layout Subsubsection
All parameters used
\end_layout

\begin_layout Standard
Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:Parameters-used"

\end_inset

 shows all parameter values used.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="11" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Parameters
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Values
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $b=b_{g}=b_{i}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $0.1$
\end_inset

, 
\begin_inset Formula $0.5$
\end_inset

, 
\begin_inset Formula $1.0$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Note Note
status open

\begin_layout Plain Layout
0.0 is utter useless
\end_layout

\end_inset


\begin_inset Formula $0.1$
\end_inset

, 
\begin_inset Formula $0.3$
\end_inset

, 
\begin_inset Formula $1.0$
\end_inset

, 
\begin_inset Formula $10^{6}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\mu=\mu_{g}=\mu_{i}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $0.0$
\end_inset

, 
\begin_inset Formula $0.1$
\end_inset

, 
\begin_inset Formula $0.2$
\end_inset

, 
\begin_inset Formula $0.4$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $t_{c}$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\strikeout default
\uuline default
\uwave default
\noun default
\color inherit

\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
crown age
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $15$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $r$
\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
mutation rate
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $10^{-1}$
\end_inset

,
\begin_inset Formula $10^{-2}$
\end_inset

,
\begin_inset Formula $10^{-3}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $l_{a}$
\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
alignment length (base pairs)
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $10^{3}$
\end_inset

,
\begin_inset Formula $10^{4}$
\end_inset

,
\begin_inset Formula $10^{5}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n_{s}$
\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Number of species trees sampled
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n_{a}$
\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Number of alignments
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n_{b}$
\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
Number of BEAST2 runs
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $l_{m}$
\end_inset


\begin_inset Note Note
status collapsed

\begin_layout Plain Layout
MCMC chain length
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $10^{6}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Parameters used
\begin_inset CommandInset label
LatexCommand label
name "tab:Parameters-used"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Analyzing the results
\end_layout

\begin_layout Standard
These posteriors were analyzed using bash (
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

www.gnu.org/software/bash
\end_layout

\end_inset

) scripts and the R programming language 
\begin_inset CommandInset citation
LatexCommand cite
key "R"

\end_inset

, using the packages rBEAST 
\begin_inset CommandInset citation
LatexCommand cite
key "rBEAST"

\end_inset

 to process BEAST2 output files, ape 
\begin_inset CommandInset citation
LatexCommand cite
key "APE"

\end_inset

 and ggplot2 
\begin_inset CommandInset citation
LatexCommand cite
key "ggplot2"

\end_inset

 for plotting and testit 
\begin_inset CommandInset citation
LatexCommand cite
key "testit"

\end_inset

 for debugging.
 All the scripts can be downloaded 
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

https://github.com/richelbilderbeek/should
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Paragraph
How well do two BEAST runs repeat (from the same alignment)?
\end_layout

\begin_layout Standard
Very good
\end_layout

\begin_layout Paragraph
How similar are the results of different alignments (of the same species
 tree)?
\end_layout

\begin_layout Standard
Good
\end_layout

\begin_layout Paragraph
How similar are the results of two different species trees (from the same
 gene tree)?
\end_layout

\begin_layout Standard
Similar
\end_layout

\begin_layout Paragraph
The effect of sequence length and mutation rate
\end_layout

\begin_layout Standard
The effects of sequence length and mutation rate are ...
\end_layout

\begin_layout Paragraph
Number of taxa
\end_layout

\begin_layout Standard
The number of taxa ...
\end_layout

\begin_layout Paragraph
Difference in nLTT plots
\end_layout

\begin_layout Standard
Protracted speciation 
\end_layout

\begin_layout Paragraph
Histogram of errors
\end_layout

\begin_layout Standard
Histogram of errors
\end_layout

\begin_layout Section
Results
\end_layout

\begin_layout Section
Discussion 
\end_layout

\begin_layout Standard
The protracted speciation model creates trees with less taxa, 
\end_layout

\begin_layout Standard
A constant-rate protracted birth-death model is used, this research could
 easily be modified to compare other protracted birth-death models, for
 example, a diversity-dependent protracted birth-death model.
 There has been now work done on the diversity-dependent protracted birth-deatg
 model yet.
\end_layout

\begin_layout Standard
This research assumes that speciation is allopatric, because in the simulation
 of the DNA alignments, there is no gene flow anymore between two taxa of
 still-the-same species.
 
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "Cer2016"
options "plain"

\end_inset


\end_layout

\begin_layout Section
\start_of_appendix
Worked-out examples
\begin_inset CommandInset label
LatexCommand label
name "sec:Worked-out-examples"

\end_inset


\end_layout

\begin_layout Standard
To better understand the steps performed in this research, I show here some
 worked-out examples in detail.
 
\end_layout

\begin_layout Subsection
Workflow
\begin_inset CommandInset label
LatexCommand label
name "sub:Workflow"

\end_inset


\end_layout

\begin_layout Standard
Every experiment has the following steps:
\end_layout

\begin_layout Itemize
Creating parameter files: see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Creating-parameter-files"

\end_inset


\end_layout

\begin_layout Itemize
Checking your parameter file: see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Checking-your-parameter-file"

\end_inset


\end_layout

\begin_layout Itemize
Do simulations: see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Do-simulations"

\end_inset


\end_layout

\begin_layout Itemize
Analyze results: see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Analyze-results"

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Workflow"

\end_inset

 shows the workflow graphically:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Workflow_experiment.svg
	scale 75

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The chronological order of the experiment
\begin_inset CommandInset label
LatexCommand label
name "fig:Workflow"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Each step can be done from a command-line script, so that a computer cluster
 can conveniently work on it.
\end_layout

\begin_layout Subsubsection
Creating parameter files
\begin_inset CommandInset label
LatexCommand label
name "sub:Creating-parameter-files"

\end_inset


\end_layout

\begin_layout Standard
Parameter files can be created from the command line by supplying all the
 arguments to the script 'create_parameter_file.R' (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:create_parameter_file.R"

\end_inset

).
 
\end_layout

\begin_layout Subsubsection
Checking your parameter file
\begin_inset CommandInset label
LatexCommand label
name "sub:Checking-your-parameter-file"

\end_inset


\end_layout

\begin_layout Standard
You can check if you created a parameter file with the correct arguments
 using the R script 'check_parameter_file.R' (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:check_parameter_file.R"

\end_inset

).
\end_layout

\begin_layout Subsubsection
Do simulations
\begin_inset CommandInset label
LatexCommand label
name "sub:Do-simulations"

\end_inset


\end_layout

\begin_layout Standard
A simulation (including its replicates) can be run from the command line
 by supplying all the arguments to the R script 'do_simulation.R' (see chapter
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:do_simulation.R"

\end_inset

).
 This will result in:
\end_layout

\begin_layout Itemize
A parameter file with intermediate data added
\end_layout

\begin_layout Itemize
BEAST2 output files
\end_layout

\begin_layout Subsubsection
Analyze results
\begin_inset CommandInset label
LatexCommand label
name "sub:Analyze-results"

\end_inset


\end_layout

\begin_layout Standard
After the simulations, the results are analyzed with the R script 'do_analyze.R'
 (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:analyse.R"

\end_inset

).
\end_layout

\begin_layout Subsection
Experiments
\end_layout

\begin_layout Standard

\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="13" columns="5">
<features tabularvalignment="middle">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Example
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Protracted?
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
No
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Yes
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
No
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Yes
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
 RNG seed
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $b=b_{g}=b_{i}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.5
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $10^{6}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $10^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $10^{6}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $10^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $\mu=\mu_{g}=\mu_{i}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.1
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $t_{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
5
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $t_{s}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $r$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
0.01
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n_{a}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $l_{a}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\uuline off
\uwave off
\noun off
\color none
1000
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n_{b}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $l_{m}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $10^{6}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Parameters used in the examples
\begin_inset CommandInset label
LatexCommand label
name "tab:Examples-parameters"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Example 1: Weak protractedness
\begin_inset CommandInset label
LatexCommand label
name "sub:Example-1-Weak-protractedness"

\end_inset


\end_layout

\begin_layout Subsubsection
Posterior
\end_layout

\begin_layout Standard
of their resemblance, their nLTT plots are put in the same chart in figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-1-posterior-sample-tree-nltt"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_1_posterior_sample_nltt_1_1_1.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The nLTTs of the true species tree (solid black line) and the species tree
 sampled from example 1 its posterior (dotted line).
 This figure is produced by the function 'plot_posterior_sample_nltts'
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-1-posterior-sample-tree-nltt"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
We can observe that the lines are close, but do not match.
 Also this is expected, due to stochasticity in the MCMC sampling.
\end_layout

\begin_layout Standard
To derive at a quantity of the match between true/input tree and the posterior,
 one can sum the error between the true and posterior tree nLTT plot, see
 [Janzen].
 For this example, the error between the true species tree and the posterior
 tree is 
\begin_inset Formula $0.026$
\end_inset

.
 The true species tree can be compared to every tree in the posterior, calculati
ng the nLTT statistic for each.
 This will results in the following histogram:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_1_nltt_stats_1_1_1.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Histogram of the nLTT statistic between the true species tree and the trees
 in the posterior.
 This figure is produced by the function 'plot_posterior_nltt_stats_histogram'
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-1-nltt-stats"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Here we can see that this histogram looks a bit like a Poisson or Gamma
 distribution, with a median at 
\begin_inset Formula $0.02-0.025$
\end_inset

.
 
\end_layout

\begin_layout Standard
But this does not tell us where the errors have been made: near the crown,
 near the tips, or in between? To do so, we plot the average nLTT plot of
 the posterior and compare it to the true species tree its nLTT, as shown
 in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-1-posterior-average-nltt"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_1_posterior_average_nltt_1_1_1.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Average nLTT of all the trees in the posterior.
 Solid line: nLTT of true species tree.
 Dotted line: average nLTT of all posterior trees.
 This figure is produced using the function 'plot_posterior_average_nltts'
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-1-posterior-average-nltt"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Example 2: Strong protractedness
\begin_inset CommandInset label
LatexCommand label
name "sub:Example-2-Strong-protractedness"

\end_inset


\end_layout

\begin_layout Standard
This example answers the question: how do the analyses of this research
 look like for strong protractedness?
\end_layout

\begin_layout Standard
The pipeline is identical, except one parameter is changed: the speciation
 completion rate 
\begin_inset Formula $\lambda$
\end_inset

 is set to a low value.
\end_layout

\begin_layout Subsubsection
Gene tree
\end_layout

\begin_layout Standard
The gene tree simulated is shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-2-gene-tree"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_2_gene_tree.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Example 2 gene tree.
 The taxon labels are S[genus]-[species]-[sub-species]'
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-2-gene-tree"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Note that there are only four complete species here, called S1-1 to S4-4.
 The third label is the sub-species label.
 Also note that S1-1 is a polyphylic species.
\end_layout

\begin_layout Subsubsection
Species tree
\begin_inset CommandInset label
LatexCommand label
name "sub:Species-tree"

\end_inset


\end_layout

\begin_layout Standard
From that gene tree, we create a species tree by sampling one individual
 per species.
 With speciation taking a long time to complete, there are indeed many incipient
 species present, and only four different full species.
 Random picking one individual per species, and adding an outgroup, results
 in the species tree of figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-2-species-tree"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_2_species_tree_with_outgroup_1.png
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_2_species_tree_with_outgroup_nltt_1.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Example 2 species tree
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-2-species-tree"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Paragraph
Gene tree and all species trees
\end_layout

\begin_layout Standard
Doing this multiple times:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_2_gene_tree_versus_species_trees.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Example 2 gene tree (black solid line) and possible sampled species tree
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-2-species-tree-1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Alignment
\end_layout

\begin_layout Standard
The DNA sequences are simulated over the species tree.
 Because there have been only four species and one outgroup, there will
 be five DNA sequences generated, as shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-2-alignment"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_2_alignment_1_1.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Example 2 alignment
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-2-alignment"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Posterior
\end_layout

\begin_layout Standard
BEAST2 is again used to create a representative sample of all possible trees
 (and parameter estimates) from those alignments and checked visually by
 Tracer (see figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-2-ess-and-trace"

\end_inset

).
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename example_2_trace.png
	lyxscale 50
	width 100text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Example 2 its ESSes and trace log
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-2-ess-and-trace"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Again all ESS values are above 200 and that the trace log shows a well-mixed
 chain.
 
\end_layout

\begin_layout Standard
Also here, we pick a random tree from the posterior (in this case, the last
 one):
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_2_posterior_sample_1_1_1.png
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_2_posterior_sample_nltt_1_1_1.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
A random species tree (and its nLTT plot) from example 2 its posterior
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-2-posterior-sample-tree"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
We expect this tree from the posterior to match the true species tree less
 well, as all the tools used assume instant speciation, where we simulated
 tree with protracted speciation.
 To clearly view the difference, the nLTT plots are put in one chart, as
 shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-2-both-nLTTs"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_2_posterior_sample_nltt_1_1_1.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Both examples 2 its nLTT plots in the same chart.
 The solid black line is the 'true' or initial (species) tree (with outgroup),
 the dotted line is one of the trees in the BEAST2 posterioir
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-2-both-nLTTs"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
We can observe that the lines are more blocky, as there are less lineages.
 In this case, the surface between the nLTT statistic of the true species
 tree and the posterior tree is 
\begin_inset Formula $0.071$
\end_inset

.
 
\end_layout

\begin_layout Standard
A posterior contains many phylogenies.
 Before analysing them, the tool 'densitree' can be used to view these
\begin_inset Note Note
status open

\begin_layout Plain Layout
TODO: use phangorn's densitree and automatically generate this graphic
\end_layout

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename example_2_densitree.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Example 2 its posterior its phylogenies
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-2-densitree"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
When scoring the nLTT statistic between the true species tree to every tree
 in the posterior, this will results in the histogram as shown in figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-2-nltt-stats"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_2_nltt_stats_1_1_1.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Histogram of the nLTT statistic between the true species tree and the trees
 in the posterior
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-2-nltt-stats"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
This histogram looks a bit like a Gamma distribution, with a median at 
\begin_inset Formula $0.75$
\end_inset

-
\begin_inset Formula $0.80$
\end_inset

 [?TODO: test if this is so?].
 
\end_layout

\begin_layout Standard
But this does not tell us where the errors have been made: near the crown,
 near the tips, or in between? To do so, we plot the average nLTT plot of
 the posterior and compare it to the true species tree its nLTT, as shown
 in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-2-posterior-average-nltt"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_2_posterior_average_nltt_1_1_1.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Average nLTT of all the trees in the posterior.
 Full line: nLTT of true species tree.
 Dotted line: average nLTT of all posterior trees
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-2-posterior-average-nltt"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Here we can see that the posterior builds up its branches around certain
 timepoints: suitable phylogenies obtain their first added branch between
 0.0-0.3, their second between 0.3 and 0.6, and their third between 0.6 and 0.9.
 This nearly always lags the true species tree.
\end_layout

\begin_layout Subsection
Comparing example 1 and 2
\begin_inset CommandInset label
LatexCommand label
name "sub:Comparing-example-1-and-2"

\end_inset


\end_layout

\begin_layout Standard
Both examples showed a histogram of the error between true species tree
 and posterior trees.
 We expect these errors to have a different distribution: example #1 assumed
 instant speciation, which suits the algorithm best, where example #2 has
 a strong protractedness.
 Plotting both histograms in the same plot results in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-both-nltt-stats"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_12_nltt_stats_histogram.png
	lyxscale 20
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Histogram of the nLTT statistic of the two examples 
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-both-nltt-stats"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
It can be observed that these error distributions have a different median.
 This means that there is an observable higher error being made when the
 true species tree is protracted.
 
\end_layout

\begin_layout Standard
This visualization does not tell use how the error is made: is the error
 concentrated at the root, middle or tips of the tree? To locate this, the
 average nLTT plots of the posterior is shown in figure :
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_12_average_nltts.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Average nLTTs of the posteriors of example #1 (weak protractedness, solid
 line) and example #2 (strong protractedness, dotted line)
\begin_inset CommandInset label
LatexCommand label
name "fig:Examples-posterior-average-nltt"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Example 3: Weak protractedness with replicates
\end_layout

\begin_layout Standard
This example is an extension of the examples 1, with the differences that:
\end_layout

\begin_layout Itemize
From the (same) gene tree, multiple species trees are sampled
\end_layout

\begin_layout Itemize
Per species tree, multiple DNA alignments are simulated
\end_layout

\begin_layout Itemize
Per DNA alignment, multiple BEAST2 runs are performed
\end_layout

\begin_layout Subsubsection
Gene tree
\end_layout

\begin_layout Standard
The first step is to simulate a gene tree.
 Because the RNG seed is at the same value as example #1, exactly the same
 gene tree will be obtained, as can be seen in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-3-gene-tree"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_gene_tree.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Example 3 gene tree.
 The taxon labels are S[genus]-[species]-[sub-species]'
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-3-gene-tree"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Species tree
\end_layout

\begin_layout Standard
It has little use to sample multiple species trees from a gene tree, as
 these are identical for instant speciation models.
 In this example, we do sample a species trees twice from the true gene
 tree.
 This results in two identical species trees, as can be verified by figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-3-species-tree"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_species_tree_with_outgroup_1.png
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_species_tree_with_outgroup_nltt_1.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_species_tree_with_outgroup_2.png
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_species_tree_with_outgroup_nltt_2.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Example 3 species tree and nLTT plot of that species tree
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-3-species-tree"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Paragraph
Gene tree and all species trees
\end_layout

\begin_layout Standard
Doing this multiple times anyways:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_gene_tree_versus_species_trees.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Example 3 gene tree (black solid line) and possible sampled species tree
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-3-gene_tree_versu_species-trees"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Alignment
\end_layout

\begin_layout Standard
From these (in this case identical) species trees, multiple alignments can
 be simulated.
 In this example, for every species tree, there are two alignments simulated.
 Because in this example, there are two species sampled, and every species
 tree has two alignments simulated, this results in four alignments.
\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-3-alignment"

\end_inset

 shows a visualisation of the simulated alignments of our example:
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_alignment_1_1.png
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_alignment_1_2.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_alignment_2_1.png
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_alignment_2_2.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Example 3 alignments
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-3-alignment"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Each alignment is different.
\end_layout

\begin_layout Subsubsection
Posterior
\end_layout

\begin_layout Standard
In this example, for each alignment, we do two BEAST2 runs, instead of one.
 It is expected (or: it should be the case) that both runs create a similar
 posterior.
 Because this example has 2 species trees, 2 alignments per species tree
 and 2 BEAST2 runs per alignment, 8 different-yet-similar posteriors are
 expected.
\end_layout

\begin_layout Paragraph
Last tree
\end_layout

\begin_layout Standard
The last trees picked from the eight different posterior are shown in figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-3-posterior-sample-tree"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_sample_1_1_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_sample_1_1_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_sample_1_2_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_sample_1_2_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_sample_2_1_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_sample_2_1_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_sample_2_2_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_sample_2_2_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The random species trees from example 3 its posteriors
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-3-posterior-sample-tree"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The species tree picked from the posterior all are different, but not too
 different (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-3-species-tree"

\end_inset

).
 
\end_layout

\begin_layout Paragraph
Do posteriors contain paraphylies?
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_paraphyly_count.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Count of the number of monophylies in all example 3 its BEAST2 posteriors
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-3-paraphyly_count"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Never, which is expected, as there is no protractedness
\end_layout

\begin_layout Paragraph
Seperate nLTT plots
\end_layout

\begin_layout Standard
Each its nLTT plot is compared to the original species tree, which is shown
 in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-3-both-nLTTs"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_sample_nltt_1_1_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_sample_nltt_1_1_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_sample_nltt_1_2_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_sample_nltt_1_2_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_sample_nltt_2_1_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_sample_nltt_2_1_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_sample_nltt_2_2_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_sample_nltt_2_2_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
All example 3 its nLTT plots compare to the true species tree nLTT.
 The solid black line is the 'true' or initial (species) tree (with outgroup),
 the dotted line is one of the trees in the BEAST2 posterioir
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-3-both-nLTTs"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In all cases, we can observe that the lines are close, but do not match.
 Also this is expected, due to stochasticity in the MCMC sampling.
\end_layout

\begin_layout Paragraph
nLTT plots of BEAST runs
\end_layout

\begin_layout Standard
To see how well the posteriors match, the nLTT plots of the BEAST runs are
 plotted in the same graphs:
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_1_1_beast_repeatability.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_1_2_beast_repeatability.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_2_1_beast_repeatability.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_2_2_beast_repeatability.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
All example 3 its nLTT plots compare to the true species tree nLTT.
 The solid black line is the 'true' or initial (species) tree (with outgroup),
 the dotted lines are the average nLTT of the BEAST2 posterior
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-3-beast-repeatability"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The BEAST2 runs appear to have converged to a similar posterior.
 
\end_layout

\begin_layout Paragraph
nLTT plots of alignments
\end_layout

\begin_layout Standard
Do the different alignments matter?
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_1_alignment_repeatability.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_2_alignment_repeatability.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
All example 3 its nLTT plots compare to the true species tree nLTT.
 The solid black line is the 'true' or initial (species) tree (with outgroup),
 the dotted lines are the average nLTT of the BEAST2 posterior of both alignment
 both its runs
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-3-alignment-repeatability"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The different alignments do matter.
\end_layout

\begin_layout Paragraph
nLTT plots of species trees
\end_layout

\begin_layout Standard
Do the different species tree matter?
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_species_tree_repeatability.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
All example 3 its nLTT plots compare to the true species tree nLTT.
 The solid black line is the 'true' or initial (species) tree (with outgroup),
 the dotted lines are the average nLTT of the BEAST2 posterior of both species
 trees of both alignment both its runs
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-3-alignment-repeatability-1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
A bit.
\end_layout

\begin_layout Paragraph
Errors
\end_layout

\begin_layout Standard
For each tree in each of the posteriors, the error is put in a histogram
 as shown by figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-3-nltt-stats"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_nltt_stats_1_1_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_nltt_stats_1_1_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_nltt_stats_1_2_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_nltt_stats_1_2_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_nltt_stats_2_1_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_nltt_stats_2_1_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_nltt_stats_2_2_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_nltt_stats_2_2_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Histogram of the nLTT statistic between the true species tree and the trees
 in the posterior
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-3-nltt-stats"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
But this does not tell us where the errors have been made: near the crown,
 near the tips, or in between? To do so, we plot the average nLTT plot of
 the posterior and compare it to the true species tree its nLTT, as shown
 in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-3-posterior-average-nltt"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_average_nltt_1_1_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_average_nltt_1_1_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_average_nltt_1_2_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_average_nltt_1_2_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_average_nltt_2_1_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_average_nltt_2_1_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_average_nltt_2_2_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_3_posterior_average_nltt_2_2_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Average nLTT of all the trees in the posterior.
 Solid line: nLTT of true species tree.
 Dotted line: average nLTT of all posterior trees
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-3-posterior-average-nltt"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Example 4: Strong protractedness with replicates
\end_layout

\begin_layout Standard
This example is an extension of the previous examples, with the differences
 that:
\end_layout

\begin_layout Itemize
From the (same) gene tree, multiple species trees are sampled
\end_layout

\begin_layout Itemize
Per species tree, multiple DNA alignments are simulated
\end_layout

\begin_layout Itemize
Per DNA alignment, multiple BEAST2 runs are performed
\end_layout

\begin_layout Subsubsection
Gene tree
\end_layout

\begin_layout Standard
The first step is to simulate a gene tree.
 Because the RNG seed is at the same value as example #1, exactly the same
 gene tree will be obtained, as can be seen in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-4-gene-tree"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_gene_tree.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Example 4 gene tree.
 The taxon labels are S[genus]-[species]-[sub-species]'
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-4-gene-tree"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Species tree
\end_layout

\begin_layout Standard
As there are multiple sub-species present for the same species, it makes
 sense to sample multiple species trees from a gene tree.
 In this example, we do sample a species trees twice from the true gene
 tree.
 This results in two different species trees, as can be verified by figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-4-species-tree"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_species_tree_with_outgroup_1.png
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_species_tree_with_outgroup_nltt_1.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_species_tree_with_outgroup_2.png
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_species_tree_with_outgroup_nltt_2.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Example 4 species tree and nLTT plot of that species tree
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-4-species-tree"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
It is a bit of bad luck that the random number generator picked two very
 similar species trees: would, instead of 
\end_layout

\begin_layout Paragraph
Gene tree and all species trees
\end_layout

\begin_layout Standard
Doing this multiple times:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_gene_tree_versus_species_trees.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Example 4 gene tree (black solid line) and possible sampled species tree
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-4-gene_tree_versu_species-trees"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Alignment
\end_layout

\begin_layout Standard
From these (in this case identical) species trees, multiple alignments can
 be simulated.
 In this example, for every species tree, there are two alignments simulated.
 Because in this example, there are two species sampled, and every species
 tree has two alignments simulated, this results in four alignments.
\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-4-alignments"

\end_inset

 shows a visualisation of the simulated alignments of our example.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_alignment_1_1.png
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_alignment_1_2.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_alignment_2_1.png
	lyxscale 50
	width 50text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_alignment_2_2.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Example 4 alignments
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-4-alignments"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Each alignment is different.
\end_layout

\begin_layout Subsubsection
Posterior
\end_layout

\begin_layout Standard
In this example, for each alignment, we do two BEAST2 runs, instead of one.
 It is expected (or: it should be the case) that both runs create a similar
 posterior.
 Because this example has 2 species trees, 2 alignments per species tree
 and 2 BEAST2 runs per alignment, 8 different-yet-similar posteriors are
 expected.
\end_layout

\begin_layout Paragraph
Last tree
\end_layout

\begin_layout Standard
The last trees picked from the eight different posterior are shown in figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-4-posterior-sample-tree"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_sample_1_1_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_sample_1_1_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_sample_1_2_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_sample_1_2_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_sample_2_1_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_sample_2_1_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_sample_2_2_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_sample_2_2_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The random species trees from example 3 its posteriors
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-4-posterior-sample-tree"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The species tree picked from the posterior all are different, but not too
 different (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-4-species-tree"

\end_inset

).
 
\end_layout

\begin_layout Paragraph
Do posteriors contain paraphylies?
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_paraphyly_count.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Count of the number of monophylies in all example 4 its BEAST2 posteriors
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-4-paraphyly_count-1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Never BEAST2 creates monophyletic trees.
 
\end_layout

\begin_layout Paragraph
Seperate nLTT plots
\end_layout

\begin_layout Standard
Each its nLTT plot is compared to the original species tree, which is shown
 in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-4-both-nLTTs"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_sample_nltt_1_1_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_sample_nltt_1_1_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_sample_nltt_1_2_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_sample_nltt_1_2_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_sample_nltt_2_1_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_sample_nltt_2_1_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_sample_nltt_2_2_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_sample_nltt_2_2_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
All example 4 its nLTT plots compare to the true species tree nLTT.
 The solid black line is the 'true' or initial (species) tree (with outgroup),
 the dotted line is one of the trees in the BEAST2 posterioir
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-4-both-nLTTs"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In all cases, we can observe that the lines are close, but do not match.
 Also this is expected, due to stochasticity in the MCMC sampling.
\end_layout

\begin_layout Paragraph
nLTT plots of BEAST runs
\end_layout

\begin_layout Standard
To see how well the posteriors match, the nLTT plots of the BEAST runs are
 plotted in the same graphs:
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_1_1_beast_repeatability.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_1_2_beast_repeatability.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_2_1_beast_repeatability.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_2_2_beast_repeatability.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
All example 4 its nLTT plots compare to the true species tree nLTT.
 The solid black line is the 'true' or initial (species) tree (with outgroup),
 the dotted lines are the average nLTT of the BEAST2 posterior
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-4-beast-repeatability"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The BEAST2 runs appear to have converged to a similar posterior.
 
\end_layout

\begin_layout Paragraph*
nLTT plots of alignments
\end_layout

\begin_layout Standard
Do the different alignments matter?
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_1_alignment_repeatability.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_2_alignment_repeatability.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
All example 4 its nLTT plots compare to the true species tree nLTT.
 The solid black line is the 'true' or initial (species) tree (with outgroup),
 the dotted lines are the average nLTT of the BEAST2 posterior of both alignment
 both its runs
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-4-alignment-repeatability"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The different alignments do matter.
\end_layout

\begin_layout Paragraph
nLTT plots of species trees
\end_layout

\begin_layout Standard
Do the different species tree matter?
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_species_tree_repeatability.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
All example 4 its nLTT plots compare to the true species tree nLTT.
 The solid black line is the 'true' or initial (species) tree (with outgroup),
 the dotted lines are the average nLTT of the BEAST2 posterior of both species
 trees of both alignment both its runs
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-4-species_tree-repeatability"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
A bit.
\end_layout

\begin_layout Paragraph
Error
\end_layout

\begin_layout Standard
For each tree in each of the posteriors, the error is put in a histogram
 as shown by figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-4-nltt-stats"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_nltt_stats_1_1_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_nltt_stats_1_1_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_nltt_stats_1_2_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_nltt_stats_1_2_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_nltt_stats_2_1_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_nltt_stats_2_1_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_nltt_stats_2_2_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_nltt_stats_2_2_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Histogram of the nLTT statistic between the true species tree and the trees
 in the posterior
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-4-nltt-stats"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
But this does not tell us where the errors have been made: near the crown,
 near the tips, or in between? To do so, we plot the average nLTT plot of
 the posterior and compare it to the true species tree its nLTT, as shown
 in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-4-posterior-average-nltt"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_average_nltt_1_1_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_average_nltt_1_1_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_average_nltt_1_2_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_average_nltt_1_2_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_average_nltt_2_1_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_average_nltt_2_1_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_average_nltt_2_2_1.png
	lyxscale 50
	width 35text%

\end_inset


\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_4_posterior_average_nltt_2_2_2.png
	lyxscale 50
	width 35text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Average nLTT of all the trees in the posterior.
 Solid line: nLTT of true species tree.
 Dotted line: average nLTT of all posterior trees
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-4-posterior-average-nltt"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Comparing example 3 and 4
\end_layout

\begin_layout Standard
Both examples showed a histogram of the error between true species tree
 and posterior trees.
 We expect these errors to have a different distribution: example 3 assumed
 instant speciation, which suits the algorithm best, where example 4 has
 a strong protractedness.
 Plotting both histograms in the same plot results in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-34-both-nltt-stats"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_34_nltt_stats_histogram.png
	lyxscale 20
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Histogram of the nLTT statistic of the two examples 
\begin_inset CommandInset label
LatexCommand label
name "fig:Example-34-both-nltt-stats"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
It can be observed that these error distributions have a different median.
 This means that there is an observable higher error being made when the
 true species tree is protracted.
 
\end_layout

\begin_layout Standard
Because of the number of repeats, there are more data points, as all are
 lumped together.
\end_layout

\begin_layout Standard
This visualization does not tell use how the error is made: is the error
 concentrated at the root, middle or tips of the tree? To locate this, the
 average nLTT plots of the posterior is shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Examples-34-posterior-average-nltt"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename /home/p230198/GitHubs/R/Peregrine/example_34_average_nltts.png
	lyxscale 50
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Average nLTTs of the posteriors of example #3 (weak protractedness, solid
 line) and example #4 (strong protractedness, dotted line)
\begin_inset CommandInset label
LatexCommand label
name "fig:Examples-34-posterior-average-nltt"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Bash scripts
\end_layout

\begin_layout Standard
Running scripts locally:
\end_layout

\begin_layout Itemize
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

create_parameters_[X].sh
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

./do_simulation_[X].sh
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

./analyse_[X].sh
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Running scrips on cluster:
\end_layout

\begin_layout Itemize
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

sbatch ./create_parameters_[X]_job.sh
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

sbatch ./do_simulation_[X]_job.sh
\end_layout

\end_inset


\end_layout

\begin_layout Itemize
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

sbatch ./analyse_[X]_job.sh
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Formula:
\end_layout

\begin_layout Standard
\begin_inset Formula $\textnormal{filename}=\left\{ \begin{array}{c}
\textnormal{create\_parameters}\\
\textnormal{do\_simulation}\\
\textnormal{analyse}
\end{array}\right\} \textnormal{\_}\left\{ \begin{array}{c}
\textnormal{toy\_examples}\\
\textnormal{examples}\\
\textnormal{article}
\end{array}\right\} \textnormal{\_}\left\{ \begin{array}{c}
\textnormal{.sh}\\
\textnormal{job.sh}
\end{array}\right\} $
\end_inset


\end_layout

\begin_layout Subsection
analyse_article.sh
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/analyse_article.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The script
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
analyse_article_job.sh
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/analyse_article_job.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The script
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
analyse_examples.sh
\end_layout

\begin_layout Standard
This bash script analyzes the the results of the worked-out examples (chapter
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Worked-out-examples"

\end_inset

) and is displayed in algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:do_analyze_examples.sh"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/analyse_examples.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'analyse_examples.sh' script 
\begin_inset CommandInset label
LatexCommand label
name "alg:do_analyze_examples.sh"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The first line of the file indicates that it is a bash script.
 Then the R script file 'do_analyze.R' (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:analyse.R"

\end_inset

) is called with one or more parameter filenames.
\end_layout

\begin_layout Subsection
analyse_examples_job.sh
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/analyse_examples_job.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The script
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
analyse_toy_examples.sh
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/analyse_toy_examples.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The script
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
analyse_toy_examples_job.sh
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/analyse_toy_examples_job.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The script
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
check_parameters_examples.sh
\begin_inset CommandInset label
LatexCommand label
name "sub:check_example_parameter_files.sh"

\end_inset


\end_layout

\begin_layout Standard
This bash script shows how to check the example parameter files:
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/check_parameters_examples.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'check_parameters_examples.sh' script 
\begin_inset CommandInset label
LatexCommand label
name "alg:check_example_parameter_files.sh"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The bash script indicates in its first line that it is a bash script.
 The next two lines call an R script file called 'check_parameter_file.R'
 (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:check_parameter_file.R"

\end_inset

) with the parameter filename.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand verbatiminput
filename "/home/p230198/GitHubs/R/Peregrine2/check_example_parameter_files.txt"
lstparams "breaklines=true,language={R},showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Output of 'check_example_parameter_files.sh' 
\begin_inset CommandInset label
LatexCommand label
name "alg:check_example_parameter_files.txt"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
create_parameters_article.sh
\begin_inset CommandInset label
LatexCommand label
name "sub:create_article_parameter_files.sh"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/create_parameters_article.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'create_parameters_article.sh' script 
\begin_inset CommandInset label
LatexCommand label
name "alg:create_article_parameter_file.sh"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The first line indicates that this file is a bash script.
 Then it creates all parameter files.
\end_layout

\begin_layout Subsection
create_parameters_article_job.sh
\begin_inset CommandInset label
LatexCommand label
name "sub:create_article_parameter_files_job.sh"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/create_parameters_article_job.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'create_parameters_article_job.sh' script 
\begin_inset CommandInset label
LatexCommand label
name "alg:create_article_parameter_file.sh-1"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
A Peregrine cluster job script, calling 'create_parameters_article.sh' (chapter
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:create_article_parameter_files.sh"

\end_inset

).
\end_layout

\begin_layout Standard
On the Peregrine cluster, call this with:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

sbatch ./create_parameters_article_job.sh
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
create_parameters_examples.sh
\begin_inset CommandInset label
LatexCommand label
name "sub:create_example_parameter_file.sh"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/create_parameters_examples.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'create_parameters_examples.sh' script 
\begin_inset CommandInset label
LatexCommand label
name "alg:create_example_parameter_file.sh"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The first line indicates that this file is a bash script.
 The next two lines call the R script file called 'create_parameter_file.R'
 (see chapter TODO) with the 14 parameter arguments.
\end_layout

\begin_layout Subsection
create_parameters_examples_job.sh
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/create_parameters_examples_job.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The script
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
create_parameters_toy_examples.sh
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/create_parameters_toy_examples.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The script
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
create_parameters_toy_examples_job.sh
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/create_parameters_toy_examples_job.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The script
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
do_simulation_article.sh
\begin_inset CommandInset label
LatexCommand label
name "sub:do_simulation_article.sh"

\end_inset


\end_layout

\begin_layout Standard
This scripts runs all simulations of the article, as shown in algorithm
 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:do_simulation_article.sh"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/do_simulation_article.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'do_simulation_article.sh' script 
\begin_inset CommandInset label
LatexCommand label
name "alg:do_simulation_article.sh"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The bash script indicates in its first line that it is a bash script, then
 call an R script file called 'do_simulation.R' (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:do_simulation.R"

\end_inset

) with the parameter file its name.
 
\end_layout

\begin_layout Subsection
do_simulation_article_job.sh
\begin_inset CommandInset label
LatexCommand label
name "sub:do_simulation_article_job.sh"

\end_inset


\end_layout

\begin_layout Standard
This scripts sbatches all simulations of the article, as shown in algorithm
 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:do_simulation_article_job.sh"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/do_simulation_article_job.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'do_simulation_article_job.sh' script 
\begin_inset CommandInset label
LatexCommand label
name "alg:do_simulation_article_job.sh"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The bash script indicates in its first line that it is a bash script, then
 call an R script file called 'do_simulation.R' (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:do_simulation.R"

\end_inset

) with the parameter file its name.
 
\end_layout

\begin_layout Subsection
do_simulation_examples.sh
\begin_inset CommandInset label
LatexCommand label
name "sub:do_simulation_examples.sh"

\end_inset


\end_layout

\begin_layout Standard
This scripts locally runs all simulations of the worked-out examples, as
 shown in algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:do_simulation_examples.sh"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/do_simulation_examples.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'do_simulation_examples.sh' script 
\begin_inset CommandInset label
LatexCommand label
name "alg:do_simulation_examples.sh"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The bash script indicates in its first line that it is a bash script, then
 call an R script file called 'do_simulation.R' (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:do_simulation.R"

\end_inset

) with the parameter file its name.
 
\end_layout

\begin_layout Subsection
do_simulation_examples_job.sh
\begin_inset CommandInset label
LatexCommand label
name "sub:do_simulation_examples_job.sh"

\end_inset


\end_layout

\begin_layout Standard
This scripts sbatches all simulations of the article, as shown in algorithm
 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:do_simulation_examples_job.sh"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/do_simulation_examples_job.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'do_simulation_examples_job.sh' script 
\begin_inset CommandInset label
LatexCommand label
name "alg:do_simulation_examples_job.sh"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The bash script indicates in its first line that it is a bash script, then
 call an R script file called 'do_simulation.R' (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:do_simulation.R"

\end_inset

) with the parameter file its name.
 
\end_layout

\begin_layout Subsection
do_simulation_toy_examples.sh
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/do_simulation_toy_examples.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The script
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
do_simulation_toy_examples_job.sh
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/do_simulation_toy_examples_job.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The script
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
sbatch_me.sh
\begin_inset CommandInset label
LatexCommand label
name "sub:sbatch_me.sh"

\end_inset


\end_layout

\begin_layout Standard
This scripts runs a simulation on a computer cluster.
 It is shown in algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:sbatch_me.sh"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/sbatch_me.sh"
lstparams "breaklines=true,language=bash,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'sbatch_me.sh' script 
\begin_inset CommandInset label
LatexCommand label
name "alg:sbatch_me.sh"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The bash script indicates in its first line that it is a bash script.
 Then it sets up the computer cluster parameters, loads the modules for
 BEAST2 and R, then runs a simulation for the parameter filename given as
 its first argument when called.
\end_layout

\begin_layout Section
R scripts
\end_layout

\begin_layout Standard
Files that are run standalone and can be called from the command line.
\end_layout

\begin_layout Subsection
analyse.R
\begin_inset CommandInset label
LatexCommand label
name "sub:analyse.R"

\end_inset


\end_layout

\begin_layout Standard
Performs the analysis and creates the result graphs, as shown in algorithm
 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:analyse.R"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/analyse.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'analyse.R' script 
\begin_inset CommandInset label
LatexCommand label
name "alg:analyse.R"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
This script it behavior depends on the number of arguments supplied from
 the command line:
\end_layout

\begin_layout Itemize
one parameter filename: create the graphs of a single run using the R function
 'analyse_single' (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:do_analyze_single"

\end_inset

)
\end_layout

\begin_layout Itemize
multiple parameter filenames: create the graphs of mutiple runs using the
 R function 'analyse_multi' (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:do_analyze_multi"

\end_inset

)
\end_layout

\begin_layout Subsection
check_parameter_file.R
\begin_inset CommandInset label
LatexCommand label
name "sub:check_parameter_file.R"

\end_inset


\end_layout

\begin_layout Standard
The R script 'check_parameter_file.R' file prints out the parameters and
 its code is shown in algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:check_parameter_file.R"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/check_parameter_file.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'check_parameter_file.R' script 
\begin_inset CommandInset label
LatexCommand label
name "alg:check_parameter_file.R"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
First, 'check_parameter_file.R' checks if the parameter exists, after which
 it displays the parameter values.
 
\end_layout

\begin_layout Standard
The bash script 'check_example_parameter_files.sh' (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:check_example_parameter_files.sh"

\end_inset

) shows how to the example parameter files are checked.
\end_layout

\begin_layout Subsection
collect_parameters.R
\begin_inset CommandInset label
LatexCommand label
name "sub:collect_parameters.R"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/collect_parameters.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'collect_parameters.R' script 
\begin_inset CommandInset label
LatexCommand label
name "alg:collect_parameters.R"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Creates a .csv with all parameter files in the folder.
\end_layout

\begin_layout Subsection
create_parameter_file.R
\begin_inset CommandInset label
LatexCommand label
name "sub:create_parameter_file.R"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/create_parameter_file.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'create_parameter_file.R' script 
\begin_inset CommandInset label
LatexCommand label
name "alg:create_parameter_file.R"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Creates a parameter file from the parameters supplied.
 First, 'create_parameter_file.R' checks if there are the right amount of
 parameters, with the correct form.
 The last argument is the parameter file its filename.
 As the parameter file uses the R data format, it is fitting to use the
 '.RDa' extension.
\end_layout

\begin_layout Standard
Most of the work is then pushed forward to the 'save_parameters_to_file'
 function, which is described in chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:save_parameters_to_file"

\end_inset

.
\end_layout

\begin_layout Standard
The bash script 'create_example_parameter_files.sh' (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:create_example_parameter_file.sh"

\end_inset

) shows how to create the example parameter files.
\end_layout

\begin_layout Subsection
do_simulation.R
\begin_inset CommandInset label
LatexCommand label
name "sub:do_simulation.R"

\end_inset


\end_layout

\begin_layout Standard
Performs the simulation for a parameter file, as shown in algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:do_simulation.R"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/do_simulation.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'do_simulation.R' script 
\begin_inset CommandInset label
LatexCommand label
name "alg:do_simulation.R"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
'do_simulation.R' first checks if the supplied function argument is an existing
 filename.
 Then, it runs all the steps from the experiment, by calling these functions:
\end_layout

\begin_layout Itemize
'add_pbd_output': from the parameters, create a gene tree (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:add_pbd_output"

\end_inset

)
\end_layout

\begin_layout Itemize
'add_species_trees_with_outgroup': from the gene tree, create one or more
 species trees with an added outgroup (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:add_species_trees_with_outgroup"

\end_inset

)
\end_layout

\begin_layout Itemize
'add_alignments': from each species tree (with outgroup), create one or
 more simulated DNA alignments (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:add_alignments"

\end_inset

)
\end_layout

\begin_layout Itemize
'add_posteriors': for each DNA alignment, create one or more BEAST2 posterior
 files (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:add_posteriors"

\end_inset

)
\end_layout

\begin_layout Standard
The 'do_simulation_examples.sh' bash script (see chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:do_simulation_examples.sh"

\end_inset

) shows how to call 'do_simulation' for the worked-out examples.
 
\end_layout

\begin_layout Section
R functions
\end_layout

\begin_layout Standard
Functions that are called.
\end_layout

\begin_layout Standard
The functions used are listed here alphabetically.
 The chronological order of these function calls is shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Code-flow"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Workflow_code.svg
	width 33text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The chronological order of the functions called
\begin_inset CommandInset label
LatexCommand label
name "fig:Code-flow"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
add_alignments
\begin_inset CommandInset label
LatexCommand label
name "sub:add_alignments"

\end_inset


\end_layout

\begin_layout Standard
Create a simulated DNA alignment from a species tree (with outgroup).
 See algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:add_alignments.R"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/add_alignments.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'add_alignments' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:add_alignments.R"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
add_pbd_output
\begin_inset CommandInset label
LatexCommand label
name "sub:add_pbd_output"

\end_inset


\end_layout

\begin_layout Standard
Creates a gene tree from a parameter file.
 See algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:add_pbd_output.R"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/add_pbd_output.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'add_pbd_output' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:add_pbd_output.R"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
add_posteriors
\begin_inset CommandInset label
LatexCommand label
name "sub:add_posteriors"

\end_inset


\end_layout

\begin_layout Standard
For each DNA alignment, create one or more BEAST2 posterior files.
 See algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:add_posteriors.R"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/add_posteriors.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'add_posteriors' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:add_posteriors.R"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
add_species_trees_with_outgroup
\begin_inset CommandInset label
LatexCommand label
name "sub:add_species_trees_with_outgroup"

\end_inset


\end_layout

\begin_layout Standard
Creates one or more species trees from a gene tree.
 Also adds an outgroup to each species tree.
 See algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:add_species_trees_with_outgroup.R"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/add_species_trees_with_outgroup.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'add_species_trees_with_outgroup' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:add_species_trees_with_outgroup.R"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
analyse_multi
\begin_inset CommandInset label
LatexCommand label
name "sub:do_analyze_multi"

\end_inset


\end_layout

\begin_layout Standard
R function that is called to creates the result graphs for a multiple parameter
 filenames.
 This is useful to do comparisons: the first filename is assumed to be a
 non-protracted parameter file.
 See algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:do_analyze_multi.R"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/analyse_multi.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'analyse_multi' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:do_analyze_multi.R"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
It forwards the heavy lifting to other R functions.
\end_layout

\begin_layout Subsection
analyse_single
\begin_inset CommandInset label
LatexCommand label
name "sub:do_analyze_single"

\end_inset


\end_layout

\begin_layout Standard
R function that is called to creates the result graphs for a single parameter
 filename.
 See algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:do_analyze_single.R"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/analyse_single.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'analyse_single' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:do_analyze_single.R"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
It forwards the heavy lifting to other R functions.
\end_layout

\begin_layout Subsection
is_valid_file
\begin_inset CommandInset label
LatexCommand label
name "sub:is_valid_file"

\end_inset


\end_layout

\begin_layout Standard
The function 'is_valid_file' checks if a parameter file is valid, as can
 be seen in algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:is_valid_file"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/is_valid_file.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'is_valid_file' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:is_valid_file"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
It checks the parameter file its form and its parameter values.
\end_layout

\begin_layout Subsection
plot_alignments
\end_layout

\begin_layout Standard
This R function plots the alignments of a parameter file.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/plot_alignments.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'plot_alignments' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:plot_alignments"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-1-alignment"

\end_inset

 is produced by this function.
\end_layout

\begin_layout Subsection
plot_gene_tree
\end_layout

\begin_layout Standard
This R function plots the gene tree of a parameter file.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/plot_gene_tree.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'plot_gene_tree' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:plot_gene_tree"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
There is always exactly one gene tree per parameter file.
 
\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-1-gene-tree"

\end_inset

 is produced by this function.
\end_layout

\begin_layout Subsection
plot_multi_average_nltts
\end_layout

\begin_layout Standard
This R function plots the alignments of a parameter file.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/plot_multi_average_nltts.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'plot_multi_average_nltts' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:plot_multi_average_nltts"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Examples-posterior-average-nltt"

\end_inset

 is produced by this function.
\end_layout

\begin_layout Subsection
plot_multi_nltt_stats_histogram
\end_layout

\begin_layout Standard
This R function plots the alignments of a parameter file.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/plot_multi_nltt_stats_histogram.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'plot_multi_nltt_stats_histogram' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:plot_multi_nltt_stats_histogram"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-both-nltt-stats"

\end_inset

 is produced by this function.
\end_layout

\begin_layout Subsection
plot_posterior_average_nltts
\end_layout

\begin_layout Standard
For each posterior, plots the average nLTT of all phylogenies, including
 the true tree its nLTT.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/plot_posterior_average_nltts.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'plot_posterior_average_nltts' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:plot_posterior_average_nltts"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-1-posterior-average-nltt"

\end_inset

 is produced by this function.
\end_layout

\begin_layout Subsection
plot_posterior_nltt_stats_histogram
\end_layout

\begin_layout Standard
R function that creates a histogram out of the nLTT stats and puts it in
 a histogram.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/plot_posterior_nltt_stats_histogram.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'plot_nltt_stats_histogram' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:plot_nltt_stats_histogram"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-1-nltt-stats"

\end_inset

 is produced by this function.
\end_layout

\begin_layout Subsection
plot_posterior_samples
\end_layout

\begin_layout Standard
R function that plots a single tree in the posterior.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/plot_posterior_samples.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'plot_posterior_samples' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:plot_posterior_samples"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-1-posterior-sample-tree"

\end_inset

 is produced by this function.
\end_layout

\begin_layout Subsection
plot_posterior_sample_nltts
\end_layout

\begin_layout Standard
R function that plots the nLTT plot of a single tree in the posterior.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/plot_posterior_sample_nltts.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'plot_posterior_sample_nltts' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:plot_posterior_sample_nltts "

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-1-posterior-sample-tree-nltt"

\end_inset

 is produced by this function.
\end_layout

\begin_layout Subsection
plot_species_tree_with_outgroup
\end_layout

\begin_layout Standard
This R function that plots the species trees of a parameter file.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/plot_species_tree_with_outgroup.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'plot_species_tree_with_outgroup' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:plot_species_tree_with_outgroup"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
There are 
\begin_inset Formula $n_{species\_trees}$
\end_inset

 species trees per parameter file, each sampled randomly from the same species
 tree.
\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-1-species-tree"

\end_inset

 is produced by this function.
\end_layout

\begin_layout Subsection
plot_species_tree_with_outgroup_nltt
\end_layout

\begin_layout Standard
This R function that plots the species trees their nLTT plots of a parameter
 file.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/plot_species_tree_with_outgroup_nltt.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'plot_species_tree_with_outgroup_nltt' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:plot_species_tree_with_outgroup_nltt"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
There are 
\begin_inset Formula $n_{species\_trees}$
\end_inset

 species trees per parameter file, each sampled randomly from the same species
 tree.
\end_layout

\begin_layout Standard
Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Example-1-species-tree-nltt"

\end_inset

 is produced by this function.
\end_layout

\begin_layout Subsection
save_parameters_to_file
\begin_inset CommandInset label
LatexCommand label
name "sub:save_parameters_to_file"

\end_inset


\end_layout

\begin_layout Standard
The function 'save_parameters_to_file' saves the parameters to file, as
 can be seen in algorithm 
\begin_inset CommandInset ref
LatexCommand ref
reference "alg:save_parameters_to_file.R"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset CommandInset include
LatexCommand lstinputlisting
filename "/home/p230198/GitHubs/R/Peregrine/save_parameters_to_file.R"
lstparams "breaklines=true,language=R,showstringspaces=false"

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 'save_parameters_to_file' function 
\begin_inset CommandInset label
LatexCommand label
name "alg:save_parameters_to_file.R"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
At the core of this function is the creation of 'my_table', which stores
 all the parameters.
 After saving, it calls 'is_valid_file' to check the parameter file.
 Finally it checks if saving and loading of the created parameter file works
 as expected.
\end_layout

\begin_layout Section
Error
\end_layout

\begin_layout Subsection
BEAST requires Java version 8
\end_layout

\begin_layout Standard
Sometimes my Java version degrades to version 7.
 BEAST2 will show figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:BEAST2-error"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename ErrorJava8needed.png
	width 50text%

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
BEAST2 error
\begin_inset CommandInset label
LatexCommand label
name "fig:BEAST2-error"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
On the command-line do:
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

sudo apt-get install openjdk-8-jre
\end_layout

\end_inset


\end_layout

\begin_layout Standard
or
\end_layout

\begin_layout Standard
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

sudo apt-get install oracle-java8-set-default
\end_layout

\end_inset


\end_layout

\end_body
\end_document
