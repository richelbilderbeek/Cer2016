<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Richel Bilderbeek" />

<meta name="date" content="2016-05-04" />

<title>convert_alignment_to_beast_posterior demo</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>


<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>



<div class="fluid-row" id="header">


<h1 class="title">convert_alignment_to_beast_posterior demo</h1>
<h4 class="author"><em>Richel Bilderbeek</em></h4>
<h4 class="date"><em>2016-05-04</em></h4>

</div>


<p>To convert an alignment to a BEAST2 posterior:</p>
<ul>
<li>Create a phylogeny</li>
<li>Create an alignment from that phylogeny</li>
<li>Create a BEAST2 posterior from that alignment</li>
<li>Compare the BEAST2 posterior with the original phylogeny</li>
</ul>
<div id="load-the-packages" class="section level2">
<h2>Load the packages</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Cer2016)
<span class="kw">library</span>(nLTT)
<span class="kw">library</span>(phangorn)
<span class="kw">library</span>(rBEAST)</code></pre></div>
<pre><code>## Loading required package: XML</code></pre>
<pre><code>## Loading required package: phytools</code></pre>
<pre><code>## Loading required package: maps</code></pre>
<pre><code>## 
##  # maps v3.1: updated 'world': all lakes moved to separate new #
##  # 'lakes' database. Type '?world' or 'news(package=&quot;maps&quot;)'.  #</code></pre>
<pre><code>## Loading required package: data.table</code></pre>
<pre><code>## Loading required package: reshape2</code></pre>
<pre><code>## 
## Attaching package: 'reshape2'</code></pre>
<pre><code>## The following objects are masked from 'package:data.table':
## 
##     dcast, melt</code></pre>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## Warning: replacing previous import 'data.table::melt' by 'reshape2::melt'
## when loading 'rBEAST'</code></pre>
<pre><code>## Warning: replacing previous import 'data.table::dcast' by 'reshape2::dcast'
## when loading 'rBEAST'</code></pre>
<pre><code>## rBEAST 1.0.0
## https://github.com/olli0601/rBEAST</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(testit)</code></pre></div>
<p>Check if BEAST2 can be found:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#find_beast_bin_path()</span>
<span class="kw">find_beast_jar_path</span>()</code></pre></div>
<pre><code>## [1] &quot;C:/Users/Aline/BEAST/lib/beast.jar&quot;</code></pre>
</div>
<div id="create-a-phylogeny" class="section level2">
<h2>Create a phylogeny</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_taxa &lt;-<span class="st"> </span><span class="dv">5</span>
phylogeny &lt;-<span class="st"> </span>ape::<span class="kw">rcoal</span>(<span class="dt">n =</span> n_taxa)
<span class="kw">plot</span>(phylogeny)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAS1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6kNtmAABmtv+QOgCQkGaQ2/+2ZgC2Zjq2///bkDrbkGbb/9vb////tmb/25D//7b//9v///+NmUzrAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEv0lEQVR4nO3di07bShRAUfMqgRJwSxL8/19aT+wAooaNT7A9mewtXbW6FTOw5DzkY4eqsS+rlv4Gck8gSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEgg6AyAHh+aZreqquvQV5cPVF89N9ub29YoJFQ+0Lp1WbdIzebyKfDlpQOlx1bSaavzAaoyavvrofum0sMs8rP8JMykiwbrH1ib6uIh9PXFA9X9A6xZx4SKB1ofXrt2Kx9iA72xCDTY9uZu/1/7t18+xAbapGeedf9eMVLpQO37oBZm3b7e38UWKB3o6ASCBIIEggSCBIIEggSCBIIEggSCBIIEggSCzgAoTVY3VVV5Pmi4dNZ+U915yvWz1tfNy306c5/T4HCKRWPtJ6t//6TTiRmNnqcFCk5WX+4PE7Jxu/3o9z7losHVX4+b+mwGh+NWP0xW18Gz9sUDdZPVl/vgaL54oO7FfbeK+hQPtJ+q7lahF7Dxuy26aGz1brIaPn7KB0qT1fReqC12FJUOlOduAi2x6Eyrz7KbQEssOtPqs+wm0BKLzrT6LLsJtMSiM60+y24CLbHoTKvPsptASyw60+qz7JYX0GN3rqOb/Uy+23KLRld/Oyl9LoPDkav3t/vUwWvtSwc63JK5ufjt2GewbnC4vbmrQ3PDsoCGJqv7weFudRt8ji4MaOD/pQMn4QQv7igf6HDbfPB+uomApm3MD5MOnH6qEftsioyuVPluo4C62zGb/sMXfnS3bBsFtLk46n10+UDdLZnpz5xuyZy2cU/S0+2WbQJBAkECQQJBAkEfv+XvvMf+ud1OoP+APv2XKXY7gQSCBIIEggSCBIIEgsYC9ZPVTUZTjWkbCdSPe7L6DLNpGwnUTVa3NzndDjVto4D6yWpdZfVRpdM27gjaj3vqy6fgYLUwoM8mq827jyw9crcT6HOgofoj5+U+9hxdPlB/5LzOx47d7QQaBXQYycdumqfV82wU0OHIiT5HFw/UT1bDg9WTBPr2xQzN62Q1evHLSQJ9LKfr2bJMIEggSCBIIEggSCBIIEggSCBIIEggSCBIIIh+hDRZrdNpkdDgp3yg7n6o6OmgMwBKZ+2j90Lx6qcQnVGsrp6DFy7g6qfR1zeX7Q+e9PvFcvrA7ZxK8579bzHO6fes5tTbvCc2+Ske6G0mL9BQ7+Y9scsXSgdKk9XuXVBwOl860NEJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQT9A9sjF666md3SAAAAAElFTkSuQmCC" alt /></p>
</div>
<div id="create-an-alignment-from-that-phylogeny" class="section level2">
<h2>Create an alignment from that phylogeny</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">alignment &lt;-<span class="st"> </span><span class="kw">convert_phylogeny_to_alignment</span>(
  <span class="dt">phylogeny =</span> phylogeny,
  <span class="dt">sequence_length =</span> <span class="dv">10</span>
)
<span class="kw">image</span>(alignment)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /></p>
<p>From that alignment, create a BEAST2 posterior</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">base_filename &lt;-<span class="st"> &quot;convert_alignment_to_beast_posterior_test&quot;</span>

if (<span class="kw">file.exists</span>(<span class="kw">paste</span>(base_filename, <span class="st">&quot;.log&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))) {
  <span class="kw">file.remove</span>(<span class="kw">paste</span>(base_filename, <span class="st">&quot;.log&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))  
}
if (<span class="kw">file.exists</span>(<span class="kw">paste</span>(base_filename, <span class="st">&quot;.trees&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))) {
  <span class="kw">file.remove</span>(<span class="kw">paste</span>(base_filename, <span class="st">&quot;.trees&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))  
}
if (<span class="kw">file.exists</span>(<span class="kw">paste</span>(base_filename, <span class="st">&quot;.xml.state&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))) {
  <span class="kw">file.remove</span>(<span class="kw">paste</span>(base_filename, <span class="st">&quot;.xml.state&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))  
}
posterior &lt;-<span class="st"> </span><span class="kw">convert_alignment_to_beast_posterior</span>(
  alignment,
  <span class="dt">mcmc_chainlength =</span> <span class="dv">10000</span>,
  <span class="dt">base_filename =</span> base_filename,
  <span class="dt">rng_seed =</span> <span class="dv">42</span>,
  <span class="dt">beast_bin_path =</span> <span class="st">&quot;&quot;</span>,
  <span class="dt">beast_jar_path =</span> <span class="kw">find_beast_jar_path</span>()
)</code></pre></div>
<pre><code>## [1] &quot;Call BEAST2 jar by its full file path&quot;
## [1] &quot;File created by BEAST2 jar file&quot;</code></pre>
<pre><code>## Warning in readLines(file, n = 2000): incomplete final line found on
## 'convert_alignment_to_beast_posterior_test.trees'</code></pre>
</div>
<div id="plot-this-posterioir" class="section level2">
<h2>Plot this posterioir</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">last_tree &lt;-<span class="st"> </span><span class="kw">tail</span>(posterior, <span class="dt">n =</span> <span class="dv">1</span>)[[<span class="dv">1</span>]]
<span class="kw">plot</span>(last_tree, <span class="dt">main =</span> <span class="st">&quot;Last tree in posterior&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">all_nltt_stats &lt;-<span class="st"> </span><span class="ot">NULL</span>
for (tree in posterior)
{
  all_nltt_stats =<span class="st"> </span><span class="kw">c</span>(all_nltt_stats, nLTT::<span class="kw">nLTTstat</span>(phylogeny, tree))
}

<span class="kw">hist</span>(all_nltt_stats)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /></p>
</div>
<div id="cleanup" class="section level2">
<h2>Cleanup</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (<span class="kw">file.exists</span>(<span class="kw">paste</span>(base_filename, <span class="st">&quot;.log&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))) {
  <span class="kw">file.remove</span>(<span class="kw">paste</span>(base_filename, <span class="st">&quot;.log&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))  
}</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (<span class="kw">file.exists</span>(<span class="kw">paste</span>(base_filename, <span class="st">&quot;.trees&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))) {
  <span class="kw">file.remove</span>(<span class="kw">paste</span>(base_filename, <span class="st">&quot;.trees&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))  
}</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (<span class="kw">file.exists</span>(<span class="kw">paste</span>(base_filename, <span class="st">&quot;.xml.state&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))) {
  <span class="kw">file.remove</span>(<span class="kw">paste</span>(base_filename, <span class="st">&quot;.xml.state&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))  
}</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
