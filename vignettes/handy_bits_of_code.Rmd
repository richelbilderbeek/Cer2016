---
title: "Useful bits of code"
author: "Femke Thon"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Useful bits of code}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## This document shows some bits of code we've found that might come in useful later.

  First we run the simulation, as in the Research Demo. This is important so that
we'll later be able to find the stuff we need.

```{r}
  library(Cer2016)
  library(ape)

  filenames = c(
    "toy_example_1.RDa",
    "toy_example_2.RDa",
    "toy_example_3.RDa",
    "toy_example_4.RDa"
  )

  rng_seeds <- seq(1,4)
  sirgs <- rep(0.5, times = 4)
  siris <- rep(0.5, times = 4)
  scrs <- rep(1.0, times = 4)
  ergs <- rep(0.1, times = 4)
  eris <- rep(0.1, times = 4)
  ages <- rep(5, times = 4)
  n_species_trees_sampleses <- c(1, 1, 2, 2)
  mutation_rates <- rep(0.01, times = 4)
  n_alignmentses <- c(1, 1, 2, 2)
  sequence_lengths <- rep(1000, times = 4)
  mcmc_chainlengths <- rep(10000, times = 4)
  n_beast_runses <- c(1, 1, 2, 2)
  for (i in seq(1, 4)) {
    save_parameters_to_file(
      rng_seed = rng_seeds[i],
      sirg = sirgs[i],
      siri = siris[i],
      scr = scrs[i],
      erg = ergs[i],
      eri = eris[i],
      age = ages[i],
      n_species_trees_samples = n_species_trees_sampleses[i],
      add_outgroup = TRUE,
      mutation_rate = mutation_rates[i],
      n_alignments = n_alignmentses[i],
      sequence_length = sequence_lengths[i],
      mcmc_chainlength = mcmc_chainlengths[i],
      n_beast_runs = n_beast_runses[i],
      filename = filenames[i]
    )
  }

for (filename in filenames) {
    add_pbd_output(filename)
  }
for (filename in filenames) {
  add_species_trees_with_outgroup(filename)  
}
for (filename in filenames) {
  add_alignments(filename)  
}
for (filename in filenames) {
  add_posteriors(
    filename, 
    skip_if_output_present = TRUE
  )
}
  
```

Now we read the files, so we can later get stuff from the file (which is now loaded in R.)

```{r}
files  <- c()
for (filename in filenames){
  file   <- read_file(filename)
  files  <- c(files, file)
  }
```

To read these files, we can use 'str()' or 'names()'. Or at least, we can see what's in them. Also, 'summary()' can be useful.

```{r}
  names(file)
  names(file$species_trees_with_outgroup)
  names(file$posteriors)
```
