---
title: "PBD-BD gamma analysis"
author: "Femke Thon"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Analyse gamma's}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r load_packages}
library(Cer2016)
library(ggplot2)
options(warn = 2)
```

Loading some files

```
csv_filename_comparison    <- find_path("gamma_diff.csv")

df_parameters <- read_collected_parameters()

df_comparison <- read.csv(
  file = csv_filename_comparison,
  header = TRUE,
  stringsAsFactors = FALSE,
  row.names = 1
)
```

Now let's make some graphs!
```
BD <- df_parameters[
  !is.na(df_parameters$speciation_completion_rate) 
  & df_parameters$speciation_completion_rate > 2,
  ]

BD_gammas <- df_comparison[
  df_comparison$filename %in% rownames(BD),
  ]
ggplot2::qplot(diff, data = BD_gammas, binwidth = 0.005, xlim = c(-2, 2))
```

```
PBD <- df_parameters[
  !is.na(df_parameters$speciation_completion_rate)
  & df_parameters$speciation_completion_rate < 2 
  & df_parameters$speciation_completion_rate > 0,
  ]

PBD_gammas <- df_comparison[
  df_comparison$filename %in% rownames(PBD),
  ]
ggplot2::qplot(diff, data = PBD_gammas, binwidth = 0.005, xlim = c(-2, 2))
```

```
PBD_01 <- df_parameters[
  !is.na(df_parameters$speciation_completion_rate)
  & df_parameters$speciation_completion_rate == 0.1,
  ]

PBD_01_gamma <- df_comparison[
  df_comparison$filename %in% rownames(PBD_01),
  ]

ggplot2::qplot(diff, data = PBD_01_gamma, binwidth = 0.005, xlim = c(-2, 2))
```

```
PBD_02 <- df_parameters[
  !is.na(df_parameters$speciation_completion_rate)
  & df_parameters$speciation_completion_rate == 0.2,
  ]

PBD_02_gamma <- df_comparison[
  df_comparison$filename %in% rownames(PBD_02),
  ]

ggplot2::qplot(diff, data = PBD_02_gamma, binwidth = 0.005, xlim = c(-2, 2))
```

```
PBD_03 <- df_parameters[
  !is.na(df_parameters$speciation_completion_rate)
  & df_parameters$speciation_completion_rate == 0.3,
  ]

PBD_03_gamma <- df_comparison[
  df_comparison$filename %in% rownames(PBD_03),
  ]

ggplot2::qplot(diff, data = PBD_03_gamma, binwidth = 0.005, xlim = c(-2, 2))
```

```
PBD_04 <- df_parameters[
  !is.na(df_parameters$speciation_completion_rate)
  & df_parameters$speciation_completion_rate == 0.4,
  ]

PBD_04_gamma <- df_comparison[
  df_comparison$filename %in% rownames(PBD_04),
  ]

ggplot2::qplot(diff, data = PBD_04_gamma, binwidth = 0.005, xlim = c(-2, 2))
```

```
PBD_08 <- df_parameters[
  !is.na(df_parameters$speciation_completion_rate)
  & df_parameters$speciation_completion_rate == 0.8,
  ]

PBD_08_gamma <- df_comparison[
  df_comparison$filename %in% rownames(PBD_08),
  ]

ggplot2::qplot(diff, data = PBD_08_gamma, binwidth = 0.005, xlim = c(-2, 2))
```

```
PBD_10 <- df_parameters[
  !is.na(df_parameters$speciation_completion_rate)
  & df_parameters$speciation_completion_rate == 1.0,
  ]

PBD_10_gamma <- df_comparison[
  df_comparison$filename %in% rownames(PBD_10),
  ]

ggplot2::qplot(diff, data = PBD_10_gamma, binwidth = 0.005, xlim = c(-2, 2))
```

```
df_BD <- data.frame(
  scr = rep(0.1, times = length(BD_gammas$diff)),
  diff = BD_gammas$diff
)


df_PBD_all <- data.frame(
  scr = rep(PBD$speciation_completion_rate[1], times = length(PBD_gammas$diff)),
  diff = PBD_gammas$diff
)

df <- rbind(df_BD, df_PBD_all)
df$scr <- as.factor(df$scr)
```

```
ggplot2::ggplot(df, ggplot2::aes(x = diff, fill = scr)) +
    ggplot2::geom_histogram(binwidth=0.01, alpha=.5, position="identity")

ggplot2::ggplot(df, ggplot2::aes(x = diff, colour = scr)) + ggplot2::geom_density()

```
