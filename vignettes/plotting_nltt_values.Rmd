---
title: "Plotting nLTT values"
author: "Richel Bilderbeek"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Plotting nLTT values}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

This is an example from `ribi::get_average_nltt_values`:

```{r}
library(ape)
library(ggplot2)
options(warn = 2)
set.seed(42)

# Create some random phylogenies
phylogeny1 <- ape::rcoal(10)
phylogeny2 <- ape::rcoal(20)
phylogeny3 <- ape::rcoal(30)
phylogeny4 <- ape::rcoal(40)
phylogeny5 <- ape::rcoal(50)
phylogeny6 <- ape::rcoal(60)
phylogeny7 <- ape::rcoal(70)
phylogenies <- c(phylogeny1, phylogeny2, phylogeny3,
  phylogeny4, phylogeny5, phylogeny6, phylogeny7
)

# Obtain the nLTT values
dt <- 0.1
nltt_values <- get_nltt_values(phylogenies, dt = dt)
```

Here is a naive plot:

```{r}
#Plot the phylognies, where the individual nLTT values are visible
qplot(t, nltt, data = nltt_values, geom = "point",
  ylim = c(0,1),
  main = "Average nLTT plot of phylogenies", color = id, size = I(0.1)
) + stat_summary(
  fun.data = "mean_cl_boot", color = "red", geom = "smooth"
)
```

Here is another naive plot:

```{r}
# Plot the phylognies, where the individual nLTT values are omitted
qplot(
  t, nltt, data = nltt_values, geom = "blank", ylim = c(0,1),
  main = "Average nLTT plot of phylogenies"
) + stat_summary(
  fun.data = "mean_cl_boot", color = "red", geom = "smooth"
)
```

I would like to

 * Use `ggplot` instead of `qplot`
 * Add another layer, with an additional 'true' nLTT values

##  Use `ggplot` instead of `qplot`

```{r}
ggplot2::ggplot(
  data = nltt_values,
  aes(t, nltt),
  main = "Average nLTT plot of phylogenies"
) + geom_point(color = "transparent") +
  scale_x_continuous(limits = c(0, 1)) +
  scale_y_continuous(limits = c(0, 1)) +
ggplot2::stat_summary(
  fun.data = "mean_cl_boot", color = "red", geom = "smooth"
)
```

## Add another layer, with an additional 'true' nLTT values

A 'true' phylogeny needs to be simulated:

```{r}
true_phylogeny <- rcoal(10)
true_nltt_values <- get_nltt_values(list(true_phylogeny), dt = dt)
```

Here is that phylogeny:

```{r}
plot(true_phylogeny)
```

Here is that phylogeny its nLTT values added to the plot:

```{r}
ggplot2::ggplot(
  data = nltt_values,
  aes(t, nltt),
  main = "nLTT plots"
) + geom_step(
  data = true_nltt_values,
  aes(t, nltt)
) + geom_point(
  color = "transparent"
) + scale_x_continuous(
  limits = c(0, 1)
) + scale_y_continuous(
  limits = c(0, 1)
) + stat_summary(
  fun.data = "mean_cl_boot", size = 0.5, lty = "dashed", 
  color = I("black"), geom = "smooth"
) + geom_step(
  data = true_nltt_values,
  aes(t, nltt)
) 
```

As one can see, there 'true' phylogeny differs a lot from the
other phylogenies.

Too bad, there is no legend, nor title...
