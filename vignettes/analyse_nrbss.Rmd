---
title: "Normalized Rooted Branch Score"
author: "Richel Bilderbeek"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Normalized Rooted Branch Score}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

The Normalized Rooted Branch Score (NRBS) is a difference
summary statistic.

Loading this package

```{r}
library(Cer2016)
```

## Collecting NRBS values from two phylogenies

The NRBS is zero for identical trees. Let's test this:

```{r}
phylogeny1 <- ape::rcoal(10)
phylogeny2 <- phylogeny1
print(nrbs(phylogeny1 = phylogeny1, phylogeny2 = phylogeny2))
```

Now for different trees:

```{r}
phylogeny1 <- ape::rcoal(10)
phylogeny2 <- ape::rcoal(10)
print(nrbs(phylogeny1 = phylogeny1, phylogeny2 = phylogeny2))
```

## Collecting NRBS values from a file

```{r}
filename <- find_path("toy_example_3.RDa")
df <- collect_file_nrbss(filename)
testit::assert(names(df) == c("species_tree", "alignment", "beast_run", "state", "nrbs"))
testit::assert(nrow(df) == 80)
knitr::kable(head(df))
```


## Collecting NRBS values from some files

```{r}
filenames <- c(
  find_path("toy_example_1.RDa"),
  find_path("toy_example_2.RDa"),
  find_path("toy_example_3.RDa"),
  find_path("toy_example_4.RDa")
)

df <- collect_files_nrbss(filenames, verbose = FALSE)
testit::assert(names(df) == c("filename", "species_tree", "alignment", "beast_run", "state", "nrbs"))
knitr::kable(head(df))
```


## Collecting NRBS from all files

## BELOW: TODO

```
csv_filename_species_trees <- find_path("collected_nrbss.csv")
testit::assert(file.exists(csv_filename_species_trees))
testit::assert(file.exists(csv_filename_posterior))
```

Loading it from file:

```
df_species_trees <- read.csv(
 file = csv_filename_species_trees, 
 header = TRUE, 
 stringsAsFactors = FALSE, 
 row.names = 1
)

df_posterior <- read.csv(
 file = csv_filename_posterior, 
 header = TRUE, 
 stringsAsFactors = FALSE, 
 row.names = 1
)
```

Putting the head of the data frame in a table:

```
knitr::kable(head(df_species_trees))
```

```
knitr::kable(head(df_posterior))
```

What kind of data is `df_species_trees`?

```
str(df_species_trees)
names(df_species_trees)
```

What kind of data is `df_posterior`?

```
str(df_posterior)
names(df_posterior)
```

Let's first plot the distribution of nLTTs:

```
ggplot2::ggplot(
  data = df_species_trees, ggplot2::aes(df_species_trees$nltt)
) + ggplot2::geom_histogram(binwidth = 1)
```

```
ggplot2::ggplot(
  data = df_posterior, ggplot2::aes(df_posterior$nltt)
) + ggplot2::geom_histogram(binwidth = 1)
```

